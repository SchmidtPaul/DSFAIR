<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Row-column design</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/lumen.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<!--All these are favicons-->
<link rel="apple-touch-icon" sizes="180x180" href="img/logo/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="img/logo/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="img/logo/favicon-16x16.png">
<link rel="manifest" href="img/logo/site.webmanifest">
<link rel="mask-icon" href="img/logo/safari-pinned-tab.svg" color="#5bbad5">
<link rel="shortcut icon" href="img/logo/favicon.ico">
<meta name="msapplication-TileColor" content="#2d89ef">
<meta name="msapplication-config" content="img/logo/browserconfig.xml">
<meta name="theme-color" content="#ffffff">

<!--SAS syntax highlighting-->
<!--
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.31.0/codemirror.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.31.0/codemirror.min.js"></script>
<style>
  .CodeMirror {
    border: 1px solid #eee;
    height: auto;
  }
</style>
-->

<!--Metatags = preview image when linking to social media-->

<!-- Primary Meta Tags -->
<!-- <title>Mixed Models for Agriculture in R</title> -->
<!-- <meta name="title" content="Mixed Models for Agriculture in R">  -->
<!--
<meta name="description" content="Our aim is to provide a cookbook with mixed model analyses of typical examples in life sciences (focus on agriculture/biology) and compare the possibilities or rather limitations of the R-packages nlme, lme4, glmmTMB and sommer to each other, but also to SAS’ PROC MIXED.">
-->

<!-- Open Graph / Facebook -->
<!--
<meta property="og:type" content="website">
<meta property="og:url" content="https://schmidtpaul.github.io/MMFAIR/index.html">
<meta property="og:title" content="Mixed Models for Agriculture in R">
<meta property="og:description" content="Our aim is to provide a cookbook with mixed model analyses of typical examples in life sciences (focus on agriculture/biology) and compare the possibilities or rather limitations of the R-packages nlme, lme4, glmmTMB and sommer to each other, but also to SAS’ PROC MIXED.">
<meta property="og:image" content="img/logo/ScreenshotIndex.PNG">
-->

<!-- Twitter -->
<!--
<meta property="twitter:card" content="summary_large_image">
<meta property="twitter:url" content="https://schmidtpaul.github.io/MMFAIR/index.html">
<meta property="twitter:title" content="Mixed Models for Agriculture in R">
<meta property="twitter:description" content="Our aim is to provide a cookbook with mixed model analyses of typical examples in life sciences (focus on agriculture/biology) and compare the possibilities or rather limitations of the R-packages nlme, lme4, glmmTMB and sommer to each other, but also to SAS’ PROC MIXED.">
<meta property="twitter:image" content="img/logo/ScreenshotIndex.PNG">
-->

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
      a.sourceLine { display: inline-block; line-height: 1.25; }
  a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
  a.sourceLine:empty { height: 1.2em; }
  .sourceCode { overflow: visible; }
  code.sourceCode { white-space: pre; position: relative; }
  div.sourceCode { margin: 1em 0; }
  pre.sourceCode { margin: 0; }
  @media screen {
  div.sourceCode { overflow: auto; }
  }
  @media print {
  code.sourceCode { white-space: pre-wrap; }
  a.sourceLine { text-indent: -1em; padding-left: 1em; }
  }
  pre.numberSource a.sourceLine
    { position: relative; left: -4em; }
  pre.numberSource a.sourceLine::before
    { content: attr(title);
      position: relative; left: -1em; text-align: right; vertical-align: baseline;
      border: none; pointer-events: all; display: inline-block;
      -webkit-touch-callout: none; -webkit-user-select: none;
      -khtml-user-select: none; -moz-user-select: none;
      -ms-user-select: none; user-select: none;
      padding: 0 4px; width: 4em;
      color: #aaaaaa;
    }
  pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
  div.sourceCode
    { background-color: #f8f8f8; }
  @media screen {
  a.sourceLine::before { text-decoration: underline; }
  }
  code span.al { color: #ef2929; } /* Alert */
  code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
  code span.at { color: #c4a000; } /* Attribute */
  code span.bn { color: #0000cf; } /* BaseN */
  code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
  code span.ch { color: #4e9a06; } /* Char */
  code span.cn { color: #000000; } /* Constant */
  code span.co { color: #8f5902; font-style: italic; } /* Comment */
  code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
  code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
  code span.dt { color: #204a87; } /* DataType */
  code span.dv { color: #0000cf; } /* DecVal */
  code span.er { color: #a40000; font-weight: bold; } /* Error */
  code span.ex { } /* Extension */
  code span.fl { color: #0000cf; } /* Float */
  code span.fu { color: #000000; } /* Function */
  code span.im { } /* Import */
  code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
  code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
  code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
  code span.ot { color: #8f5902; } /* Other */
  code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
  code span.sc { color: #000000; } /* SpecialChar */
  code span.ss { color: #4e9a06; } /* SpecialString */
  code span.st { color: #4e9a06; } /* String */
  code span.va { color: #000000; } /* Variable */
  code span.vs { color: #4e9a06; } /* VerbatimString */
  code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
    </style>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { background-color: #f8f8f8; }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

.sourceCode .row {
  width: 100%;
}
.sourceCode {
  overflow-x: auto;
}
.code-folding-btn {
  margin-right: -30px;
}
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="styles.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 54px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 59px;
  margin-top: -59px;
}
.section h2 {
  padding-top: 59px;
  margin-top: -59px;
}
.section h3 {
  padding-top: 59px;
  margin-top: -59px;
}
.section h4 {
  padding-top: 59px;
  margin-top: -59px;
}
.section h5 {
  padding-top: 59px;
  margin-top: -59px;
}
.section h6 {
  padding-top: 59px;
  margin-top: -59px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">DSFAIR</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Examples
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="CRD_Mead1993.html">CRD_Mead1993</a>
    </li>
    <li>
      <a href="RCBD_ClewerScarisbrick2001.html">RCBD_ClewerScarisbrick2001</a>
    </li>
    <li>
      <a href="augmented_Pattersen1994.html">augmented_Pattersen1994</a>
    </li>
    <li>
      <a href="alpha_JohnWilliams1995.html">alpha_JohnWilliams1995</a>
    </li>
    <li>
      <a href="rowcol_KemptonFox1997.html">rowcol_KemptonFox1997</a>
    </li>
    <li>
      <a href="splitplot_GomezGomez1984.html">splitplot_GomezGomez1984</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Summaries
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="DesigningExperiments.html">Designing experiments</a>
    </li>
  </ul>
</li>
<li>
  <a href="0contactinfo.html">Contact</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Row-column design</h1>

</div>


<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="co"># packages</span></a>
<a class="sourceLine" id="cb1-2" title="2">pacman<span class="op">::</span><span class="kw">p_load</span>(janitor, readr, tidyverse, <span class="co"># data import and handling</span></a>
<a class="sourceLine" id="cb1-3" title="3">               lme4, lmerTest,            <span class="co"># linear mixed model </span></a>
<a class="sourceLine" id="cb1-4" title="4">               emmeans, multcomp,         <span class="co"># mean comparisons</span></a>
<a class="sourceLine" id="cb1-5" title="5">               ggplot2, desplot)          <span class="co"># plots </span></a></code></pre></div>
<div id="data" class="section level1">
<h1>Data</h1>
<p>This example is taken from Chapter <em>“3.10 Analysis of a resolvable row-column design”</em> of the course material <a href="https://www.uni-hohenheim.de/en/module-catalogue/lehrveranstaltung/mixed-models-for-metric-data-3402-451" target="_blank">“Mixed models for metric data (3402-451)”</a> by <a href="https://www.uni-hohenheim.de/organisation?tx_base_lsfcontentadmin%5BlsfPerson%5D=6257" target="_blank">Prof. Dr. Hans-Peter Piepho</a>. It considers data published in <a href="https://www.springer.com/de/book/9780412547508" target="_blank">Kempton and Fox (1997)</a> from a yield trial laid out as a resolvable row-column design. The trial had 35 genotypes (<code>gen</code>), 2 complete replicates (<code>rep</code>) with 5 rows (<code>row</code>) and 7 columns (<code>col</code>). Thus, a complete replicate is subdivided into incomplete rows and columns.</p>
<div id="import" class="section level2">
<h2>Import</h2>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="co"># data (import via URL)</span></a>
<a class="sourceLine" id="cb2-2" title="2">dataURL &lt;-<span class="st"> &quot;https://raw.githubusercontent.com/SchmidtPaul/DSFAIR/master/data/Kempton%26Fox1997.csv&quot;</span></a>
<a class="sourceLine" id="cb2-3" title="3">dat &lt;-<span class="st"> </span><span class="kw">read_csv</span>(dataURL)</a>
<a class="sourceLine" id="cb2-4" title="4"></a>
<a class="sourceLine" id="cb2-5" title="5">dat</a></code></pre></div>
<pre><code>## # A tibble: 70 x 5
##    rep     row   col gen   yield
##    &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt;
##  1 Rep1      1     1 G20    3.77
##  2 Rep1      1     2 G04    3.21
##  3 Rep1      1     3 G33    4.55
##  4 Rep1      1     4 G28    4.09
##  5 Rep1      1     5 G07    5.05
##  6 Rep1      1     6 G12    4.19
##  7 Rep1      1     7 G30    3.27
##  8 Rep1      2     1 G10    3.44
##  9 Rep1      2     2 G14    4.3 
## 10 Rep1      2     3 G16   NA   
## # ... with 60 more rows</code></pre>
</div>
<div id="formatting" class="section level2">
<h2>Formatting</h2>
<p>Before anything, the columns <code>gen</code> and <code>rep</code> should be encoded as factors, since R by default encoded them as character.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1">dat &lt;-<span class="st"> </span>dat <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb4-2" title="2"><span class="st">  </span><span class="kw">mutate_at</span>(<span class="kw">vars</span>(gen, rep), as.factor)</a></code></pre></div>
</div>
<div id="exploring" class="section level2">
<h2>Exploring</h2>
<p>In order to obtain a field layout of the trial, we can use the <code>desplot()</code> function. Notice that for this we need two data columns that identify the <code>row</code> and <code>col</code> of each plot in the trial.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"><span class="kw">desplot</span>(<span class="dt">data =</span> dat,</a>
<a class="sourceLine" id="cb5-2" title="2">        <span class="dt">form =</span> gen <span class="op">~</span><span class="st"> </span>col <span class="op">+</span><span class="st"> </span>row <span class="op">|</span><span class="st"> </span>rep,            <span class="co"># fill color per genotype, headers per replicate</span></a>
<a class="sourceLine" id="cb5-3" title="3">        <span class="dt">text =</span> gen, <span class="dt">cex =</span> <span class="fl">0.7</span>, <span class="dt">shorten =</span> <span class="st">&quot;no&quot;</span>,   <span class="co"># show genotype names per plot</span></a>
<a class="sourceLine" id="cb5-4" title="4">        <span class="dt">out1 =</span> row, <span class="dt">out1.gpar=</span><span class="kw">list</span>(<span class="dt">col=</span><span class="st">&quot;black&quot;</span>), <span class="co"># lines between rows</span></a>
<a class="sourceLine" id="cb5-5" title="5">        <span class="dt">out2 =</span> col, <span class="dt">out2.gpar=</span><span class="kw">list</span>(<span class="dt">col=</span><span class="st">&quot;black&quot;</span>), <span class="co"># lines between columns</span></a>
<a class="sourceLine" id="cb5-6" title="6">        <span class="dt">main =</span> <span class="st">&quot;Field layout&quot;</span>, <span class="dt">show.key =</span> F)     <span class="co"># formatting</span></a></code></pre></div>
<pre><code>## Warning in if (class(data) == &quot;formula&quot;) {: the condition has length &gt; 1 and only
## the first element will be used</code></pre>
<p><img src="rowcol_KemptonFox1997_files/figure-html/unnamed-chunk-5-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>When two blocking structures are used which are arranged in rows and columns, we have a <em>row-column design</em>. If rows and columns can be grouped to form complete replicates, the design is <em>resolvable</em>, as in case of one-way blocking.</p>
<p>We could also have a look at the arithmetic means and standard deviations for yield per genotype (<code>gen</code>).</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1">dat <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-2" title="2"><span class="st">  </span><span class="kw">group_by</span>(gen) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-3" title="3"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">mean    =</span> <span class="kw">mean</span>(yield, <span class="dt">na.rm=</span><span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb7-4" title="4">            <span class="dt">std.dev =</span> <span class="kw">sd</span>(yield, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-5" title="5"><span class="st">  </span><span class="kw">arrange</span>(<span class="kw">desc</span>(mean)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># sort</span></a>
<a class="sourceLine" id="cb7-6" title="6"><span class="st">  </span><span class="kw">print</span>(<span class="dt">n=</span><span class="ot">Inf</span>) <span class="co"># print full table</span></a></code></pre></div>
<pre><code>## # A tibble: 35 x 3
##    gen    mean std.dev
##    &lt;fct&gt; &lt;dbl&gt;   &lt;dbl&gt;
##  1 G19    6.07  1.84  
##  2 G07    5.74  0.976 
##  3 G33    5.13  0.820 
##  4 G06    4.96  0.940 
##  5 G09    4.94  1.68  
##  6 G11    4.93  1.03  
##  7 G14    4.92  0.877 
##  8 G27    4.89  1.80  
##  9 G03    4.78  0.0424
## 10 G25    4.78  0.361 
## 11 G21    4.76  1.27  
## 12 G20    4.75  1.39  
## 13 G05    4.72  0.686 
## 14 G01    4.69  0.757 
## 15 G32    4.62  1.21  
## 16 G18    4.6   1.24  
## 17 G12    4.59  0.559 
## 18 G34    4.51  1.16  
## 19 G08    4.36  0.488 
## 20 G13    4.36  0.361 
## 21 G17    4.22  0.580 
## 22 G16    4.2  NA     
## 23 G10    4.07  0.891 
## 24 G31    3.98  1.02  
## 25 G28    3.95  0.198 
## 26 G02    3.88  0.389 
## 27 G24    3.84  0.318 
## 28 G29    3.76  1.27  
## 29 G35    3.76  1.52  
## 30 G30    3.75  0.679 
## 31 G04    3.62  0.587 
## 32 G26    3.58  1.44  
## 33 G22    3.54  0.0778
## 34 G23    3.26  1.42  
## 35 G15    1.93 NA</code></pre>
<p>We can also create a plot to get a better feeling for the data.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> dat,</a>
<a class="sourceLine" id="cb9-2" title="2">       <span class="kw">aes</span>(<span class="dt">y =</span> yield, <span class="dt">x =</span> gen, <span class="dt">color=</span>rep)) <span class="op">+</span></a>
<a class="sourceLine" id="cb9-3" title="3"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st">  </span><span class="co"># scatter plot</span></a>
<a class="sourceLine" id="cb9-4" title="4"><span class="st">  </span><span class="kw">ylim</span>(<span class="dv">0</span>, <span class="ot">NA</span>) <span class="op">+</span><span class="st">   </span><span class="co"># force y-axis to start at 0</span></a>
<a class="sourceLine" id="cb9-5" title="5"><span class="st">  </span><span class="kw">theme_classic</span>() <span class="op">+</span><span class="st"> </span><span class="co"># clearer plot format </span></a>
<a class="sourceLine" id="cb9-6" title="6"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle=</span><span class="dv">90</span>, <span class="dt">vjust=</span><span class="fl">0.5</span>), <span class="co"># rotate x-axis label</span></a>
<a class="sourceLine" id="cb9-7" title="7">        <span class="dt">panel.grid.major.x =</span> <span class="kw">element_line</span>(), <span class="co"># add vertikal grid lines</span></a>
<a class="sourceLine" id="cb9-8" title="8">        <span class="dt">legend.position =</span> <span class="st">&quot;top&quot;</span>) <span class="co"># legend on top </span></a></code></pre></div>
<p><img src="rowcol_KemptonFox1997_files/figure-html/unnamed-chunk-7-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="modelling" class="section level1">
<h1>Modelling</h1>
<p>Finally, we can decide to fit a linear model with <code>yield</code> as the response variable and fixed <code>gen</code> and <code>rep</code> effects. There also need to be terms for the 5 rows (<code>row</code>) and 7 columns (<code>col</code>) per replicate. Notice that they can either be taken as a fixed or a random effects. Since our goal is to compare genotypes, we will determine which of the two models we prefer by comparing the average standard error of a difference (s.e.d.) for the comparisons between adjusted genotype means - the lower the s.e.d. the better.</p>
<p>Also notice that in our dataset the <code>row</code> and <code>col</code> columns were defined as <em>numeric</em> because this format is needed when creating the field layout with desplot as we did above. However, now in order to have row and column effects in our model, we need to define them as factors. To make this clear, we will not just change the format, but create a copy of these two columns in the correct format:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1">dat &lt;-<span class="st"> </span>dat <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb10-2" title="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">row_fct =</span> <span class="kw">as.factor</span>(row),</a>
<a class="sourceLine" id="cb10-3" title="3">         <span class="dt">col_fct =</span> <span class="kw">as.factor</span>(col))</a></code></pre></div>
<p>Furthermore, when building our model we must ensure that row and column effects are being estimated <strong>per replicate</strong>. Thuse, we have 2x5 row effects and 2x7 column effects. This can be done as:</p>
<div class="row">
<div class="col-md-6">
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1"><span class="co"># rows and cols fixed (linear model)</span></a>
<a class="sourceLine" id="cb11-2" title="2">mod.fb &lt;-<span class="st"> </span><span class="kw">lm</span>(yield <span class="op">~</span><span class="st"> </span>gen <span class="op">+</span><span class="st"> </span>rep <span class="op">+</span></a>
<a class="sourceLine" id="cb11-3" title="3"><span class="st">               </span>rep<span class="op">:</span>row_fct <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-4" title="4"><span class="st">               </span>rep<span class="op">:</span>col_fct,</a>
<a class="sourceLine" id="cb11-5" title="5">             <span class="dt">data =</span> dat)</a>
<a class="sourceLine" id="cb11-6" title="6"></a>
<a class="sourceLine" id="cb11-7" title="7">mod.fb <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb11-8" title="8"><span class="st">  </span><span class="kw">emmeans</span>(pairwise <span class="op">~</span><span class="st"> &quot;gen&quot;</span>,</a>
<a class="sourceLine" id="cb11-9" title="9">          <span class="dt">adjust =</span> <span class="st">&quot;tukey&quot;</span>,</a>
<a class="sourceLine" id="cb11-10" title="10">          <span class="dt">lmer.df =</span> <span class="st">&quot;kenward-roger&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb11-11" title="11"><span class="st">  </span><span class="kw">pluck</span>(<span class="st">&quot;contrasts&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># extract diffs</span></a>
<a class="sourceLine" id="cb11-12" title="12"><span class="st">  </span>as_tibble <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># format to table</span></a>
<a class="sourceLine" id="cb11-13" title="13"><span class="st">  </span><span class="kw">pluck</span>(<span class="st">&quot;SE&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># extract s.e.d. column</span></a>
<a class="sourceLine" id="cb11-14" title="14"><span class="st">  </span>mean <span class="co"># get arithmetic mean</span></a></code></pre></div>
<pre><code>## [1] 0.4083057</code></pre>
</div>
<div class="col-md-6">
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1"><span class="co"># rows and cols random (linear mixed model)</span></a>
<a class="sourceLine" id="cb13-2" title="2">mod.rb &lt;-<span class="st"> </span><span class="kw">lmer</span>(yield <span class="op">~</span><span class="st"> </span>gen <span class="op">+</span><span class="st"> </span>rep <span class="op">+</span></a>
<a class="sourceLine" id="cb13-3" title="3"><span class="st">                 </span>(<span class="dv">1</span><span class="op">|</span>rep<span class="op">:</span>row_fct) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-4" title="4"><span class="st">                 </span>(<span class="dv">1</span><span class="op">|</span>rep<span class="op">:</span>col_fct),</a>
<a class="sourceLine" id="cb13-5" title="5">               <span class="dt">data =</span> dat)</a>
<a class="sourceLine" id="cb13-6" title="6"></a>
<a class="sourceLine" id="cb13-7" title="7">mod.rb <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb13-8" title="8"><span class="st">  </span><span class="kw">emmeans</span>(pairwise <span class="op">~</span><span class="st"> &quot;gen&quot;</span>,</a>
<a class="sourceLine" id="cb13-9" title="9">          <span class="dt">adjust =</span> <span class="st">&quot;tukey&quot;</span>,</a>
<a class="sourceLine" id="cb13-10" title="10">          <span class="dt">lmer.df =</span> <span class="st">&quot;kenward-roger&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb13-11" title="11"><span class="st">  </span><span class="kw">pluck</span>(<span class="st">&quot;contrasts&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># extract diffs</span></a>
<a class="sourceLine" id="cb13-12" title="12"><span class="st">  </span>as_tibble <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># format to table</span></a>
<a class="sourceLine" id="cb13-13" title="13"><span class="st">  </span><span class="kw">pluck</span>(<span class="st">&quot;SE&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># extract s.e.d. column</span></a>
<a class="sourceLine" id="cb13-14" title="14"><span class="st">  </span>mean <span class="co"># get arithmetic mean</span></a></code></pre></div>
<pre><code>## [1] 0.4020136</code></pre>
</div>
</div>
<p>As a result, we find that the model with random row and column effects has the smaller s.e.d. and is therefore more precise in terms of comparing genotypes.</p>
<div id="anova" class="section level2">
<h2>ANOVA</h2>
<p>Thus, we can conduct an ANOVA for this model.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1">mod.rb <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">anova</span>()</a></code></pre></div>
<pre><code>## Type III Analysis of Variance Table with Satterthwaite&#39;s method
##      Sum Sq Mean Sq NumDF  DenDF F value   Pr(&gt;F)   
## gen 15.0149 0.44161    34 13.770  4.8988 0.001465 **
## rep  1.5606 1.56061     1 12.651 17.3119 0.001183 **
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>As can be seen, the F-test finds the <code>gen</code> effects to be statistically significant (p = 0.0015 &lt; 0.05).</p>
</div>
<div id="mean-comparisons" class="section level2">
<h2>Mean comparisons</h2>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1">mean_comparisons &lt;-<span class="st"> </span>mod.rb <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb17-2" title="2"><span class="st">  </span><span class="kw">emmeans</span>(pairwise <span class="op">~</span><span class="st"> &quot;gen&quot;</span>,</a>
<a class="sourceLine" id="cb17-3" title="3">          <span class="dt">adjust =</span> <span class="st">&quot;tukey&quot;</span>,</a>
<a class="sourceLine" id="cb17-4" title="4">          <span class="dt">lmer.df =</span> <span class="st">&quot;kenward-roger&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb17-5" title="5"><span class="st">  </span><span class="kw">pluck</span>(<span class="st">&quot;emmeans&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb17-6" title="6"><span class="st">  </span><span class="kw">cld</span>(<span class="dt">details =</span> <span class="ot">TRUE</span>, <span class="dt">Letters =</span> letters) <span class="co"># add letter display</span></a>
<a class="sourceLine" id="cb17-7" title="7"></a>
<a class="sourceLine" id="cb17-8" title="8">mean_comparisons<span class="op">$</span>emmeans <span class="co"># adjusted genotype means</span></a></code></pre></div>
<pre><code>##  gen emmean    SE   df lower.CL upper.CL .group
##  G15   3.22 0.443 23.5     1.62     4.81  a    
##  G23   3.42 0.304 25.6     2.34     4.51  a    
##  G04   3.52 0.305 25.5     2.43     4.61  a    
##  G35   3.60 0.309 25.8     2.50     4.70  a    
##  G26   3.76 0.316 26.8     2.64     4.88  ab   
##  G29   3.79 0.308 25.9     2.70     4.89  ab   
##  G31   3.86 0.309 26.1     2.76     4.96  ab   
##  G24   3.89 0.302 25.3     2.81     4.97  abc  
##  G02   3.91 0.309 26.1     2.82     5.01  abc  
##  G30   3.95 0.305 25.5     2.87     5.04  abc  
##  G16   3.95 0.439 22.9     2.37     5.54  abc  
##  G22   4.01 0.311 26.4     2.91     5.12  abc  
##  G17   4.15 0.312 26.1     3.04     5.26  abc  
##  G32   4.26 0.308 25.9     3.17     5.36  abc  
##  G28   4.29 0.310 25.7     3.19     5.40  abc  
##  G34   4.30 0.302 25.3     3.22     5.38  abc  
##  G20   4.32 0.302 25.3     3.24     5.40  abc  
##  G10   4.33 0.309 25.7     3.23     5.43  abc  
##  G09   4.35 0.306 25.8     3.26     5.44  abc  
##  G05   4.40 0.308 25.7     3.30     5.49  abc  
##  G18   4.56 0.310 26.4     3.46     5.67  abc  
##  G21   4.59 0.304 25.5     3.51     5.68  abc  
##  G08   4.60 0.312 26.2     3.49     5.71  abc  
##  G25   4.64 0.310 25.7     3.54     5.74  abc  
##  G13   4.68 0.312 26.1     3.57     5.79  abc  
##  G27   4.70 0.311 26.1     3.59     5.81  abc  
##  G14   4.76 0.305 25.6     3.68     5.85  abc  
##  G01   4.81 0.303 25.4     3.73     5.90  abc  
##  G33   4.91 0.312 26.2     3.81     6.02  abc  
##  G11   4.93 0.308 26.0     3.84     6.03  abc  
##  G12   4.95 0.319 26.6     3.82     6.08  abc  
##  G07   5.09 0.305 25.5     4.00     6.17  abc  
##  G03   5.10 0.311 25.8     3.99     6.20  abc  
##  G06   5.41 0.312 26.0     4.30     6.52   bc  
##  G19   5.67 0.311 25.9     4.56     6.78    c  
## 
## Results are averaged over the levels of: rep 
## Degrees-of-freedom method: kenward-roger 
## Confidence level used: 0.95 
## Conf-level adjustment: sidak method for 35 estimates 
## P value adjustment: tukey method for comparing a family of 35 estimates 
## significance level used: alpha = 0.05</code></pre>
</div>
</div>
<div id="present-results" class="section level1">
<h1>Present results</h1>
<div id="mean-comparisons-1" class="section level2">
<h2>Mean comparisons</h2>
<p>For this example we can create a plot that displays both the raw data and the results, <em>i.e.</em> the comparisons of the adjusted means that are based on the linear model.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1"><span class="co"># sort gen factors according to emmean</span></a>
<a class="sourceLine" id="cb19-2" title="2"><span class="co"># for adjusted means</span></a>
<a class="sourceLine" id="cb19-3" title="3">mean_comparisons<span class="op">$</span>emmeans &lt;-<span class="st"> </span>mean_comparisons<span class="op">$</span>emmeans <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb19-4" title="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">gen =</span> <span class="kw">fct_reorder</span>(<span class="dt">.f =</span> gen, <span class="dt">.x =</span> emmean))</a>
<a class="sourceLine" id="cb19-5" title="5"></a>
<a class="sourceLine" id="cb19-6" title="6"><span class="co"># for raw data</span></a>
<a class="sourceLine" id="cb19-7" title="7">dat &lt;-<span class="st"> </span>dat <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb19-8" title="8"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">gen =</span> <span class="kw">fct_relevel</span>(<span class="dt">.f =</span> gen, </a>
<a class="sourceLine" id="cb19-9" title="9">                           <span class="kw">as.character</span>(mean_comparisons<span class="op">$</span>emmeans<span class="op">$</span>gen)))</a>
<a class="sourceLine" id="cb19-10" title="10"></a>
<a class="sourceLine" id="cb19-11" title="11"><span class="kw">ggplot</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb19-12" title="12"><span class="st">  </span><span class="co"># black dots representing the raw data</span></a>
<a class="sourceLine" id="cb19-13" title="13"><span class="st">  </span><span class="kw">geom_point</span>(</a>
<a class="sourceLine" id="cb19-14" title="14">    <span class="dt">data =</span> dat,</a>
<a class="sourceLine" id="cb19-15" title="15">    <span class="kw">aes</span>(<span class="dt">y =</span> yield, <span class="dt">x =</span> gen)</a>
<a class="sourceLine" id="cb19-16" title="16">  ) <span class="op">+</span></a>
<a class="sourceLine" id="cb19-17" title="17"><span class="st">  </span><span class="co"># red dots representing the adjusted means</span></a>
<a class="sourceLine" id="cb19-18" title="18"><span class="st">  </span><span class="kw">geom_point</span>(</a>
<a class="sourceLine" id="cb19-19" title="19">    <span class="dt">data =</span> mean_comparisons<span class="op">$</span>emmeans,</a>
<a class="sourceLine" id="cb19-20" title="20">    <span class="kw">aes</span>(<span class="dt">y =</span> emmean, <span class="dt">x =</span> gen),</a>
<a class="sourceLine" id="cb19-21" title="21">    <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>,</a>
<a class="sourceLine" id="cb19-22" title="22">    <span class="dt">position =</span> <span class="kw">position_nudge</span>(<span class="dt">x =</span> <span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb19-23" title="23">  ) <span class="op">+</span></a>
<a class="sourceLine" id="cb19-24" title="24"><span class="st">  </span><span class="co"># red error bars representing the confidence limits of the adjusted means</span></a>
<a class="sourceLine" id="cb19-25" title="25"><span class="st">  </span><span class="kw">geom_errorbar</span>(</a>
<a class="sourceLine" id="cb19-26" title="26">    <span class="dt">data =</span> mean_comparisons<span class="op">$</span>emmeans,</a>
<a class="sourceLine" id="cb19-27" title="27">    <span class="kw">aes</span>(<span class="dt">ymin =</span> lower.CL, <span class="dt">ymax =</span> upper.CL, <span class="dt">x =</span> gen),</a>
<a class="sourceLine" id="cb19-28" title="28">    <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>,</a>
<a class="sourceLine" id="cb19-29" title="29">    <span class="dt">width =</span> <span class="fl">0.1</span>,</a>
<a class="sourceLine" id="cb19-30" title="30">    <span class="dt">position =</span> <span class="kw">position_nudge</span>(<span class="dt">x =</span> <span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb19-31" title="31">  ) <span class="op">+</span></a>
<a class="sourceLine" id="cb19-32" title="32"><span class="st">  </span><span class="co"># red letters </span></a>
<a class="sourceLine" id="cb19-33" title="33"><span class="st">  </span><span class="kw">geom_text</span>(</a>
<a class="sourceLine" id="cb19-34" title="34">    <span class="dt">data =</span> mean_comparisons<span class="op">$</span>emmeans,</a>
<a class="sourceLine" id="cb19-35" title="35">    <span class="kw">aes</span>(<span class="dt">y =</span> lower.CL, <span class="dt">x =</span> gen, <span class="dt">label =</span> .group),</a>
<a class="sourceLine" id="cb19-36" title="36">    <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>,</a>
<a class="sourceLine" id="cb19-37" title="37">    <span class="dt">angle =</span> <span class="dv">90</span>,</a>
<a class="sourceLine" id="cb19-38" title="38">    <span class="dt">hjust =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb19-39" title="39">    <span class="dt">position =</span> <span class="kw">position_nudge</span>(<span class="dt">y =</span> <span class="op">-</span><span class="st"> </span><span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb19-40" title="40">  ) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb19-41" title="41"><span class="st">  </span><span class="kw">ylim</span>(<span class="dv">0</span>, <span class="ot">NA</span>) <span class="op">+</span><span class="st"> </span><span class="co"># force y-axis to start at 0</span></a>
<a class="sourceLine" id="cb19-42" title="42"><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Yield in t/ha&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="co"># label y-axis</span></a>
<a class="sourceLine" id="cb19-43" title="43"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Genotype&quot;</span>) <span class="op">+</span><span class="st">      </span><span class="co"># label x-axis</span></a>
<a class="sourceLine" id="cb19-44" title="44"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">caption =</span> <span class="st">&quot;Black dots represent raw data</span></a>
<a class="sourceLine" id="cb19-45" title="45"><span class="st">       Red dots and error bars represent adjusted mean with 95% confidence limits per genotype</span></a>
<a class="sourceLine" id="cb19-46" title="46"><span class="st">       Means followed by a common letter are not significantly different according to the Tukey-test&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb19-47" title="47"><span class="st">  </span><span class="kw">theme_classic</span>() <span class="op">+</span><span class="st"> </span><span class="co"># clearer plot format </span></a>
<a class="sourceLine" id="cb19-48" title="48"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle=</span><span class="dv">90</span>, <span class="dt">vjust=</span><span class="fl">0.5</span>)) <span class="co"># rotate x-axis label</span></a></code></pre></div>
<pre><code>## Warning: Removed 2 rows containing missing values (geom_point).</code></pre>
<p><img src="rowcol_KemptonFox1997_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
</div>

&nbsp;
<hr />
<p style="text-align: center;">Please feel free to contact me about any of this!</p>
<p style="text-align: center;"><span style="color: #003f75ff;"><em>schmidtpaul1989@outlook.com</em></span></p>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://www.researchgate.net/profile/Paul_Schmidt17" class="fa fa-pencil" style="color: #003f75ff;"></a>
    <a href="https://www.linkedin.com/in/schmidtpaul1989/" class="fa fa-linkedin" style="color: #003f75ff;"></a>
    <a href="https://www.xing.com/profile/Paul_Schmidt393/cv" class="fa fa-xing" style="color: #003f75ff;"></a>
    <a href="https://github.com/SchmidtPaul/" class="fa fa-github" style="color: #003f75ff;"></a>
</p>

<img src="https://hitcounter.pythonanywhere.com/count/tag.svg?url=https%3A%2F%2Fschmidtpaul.github.io%2FDSFAIR%2F" alt="Hits" class="center">

&nbsp;


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("show" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
